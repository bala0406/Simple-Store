optimize read and write
make thread safe


